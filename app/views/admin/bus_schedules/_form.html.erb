<%# Shared form partial for bus schedule create/edit %>
<%# This partial is used by both new.html.erb and edit.html.erb %>

<%= form_with model: [:admin, bus_schedule], class: "space-y-6" do |form| %>
  <%# Display validation errors if any %>
  <% if bus_schedule.errors.any? %>
    <div class="bg-red-50 border border-red-400 text-red-700 px-4 py-3 rounded-lg">
      <ul class="list-disc list-inside mt-2">
        <% bus_schedule.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%# Bus Selection %>
  <div>
    <%= form.label :bus_id, "Bus", class: "block text-sm font-medium text-gray-700 mb-1" %>
    <%= form.select :bus_id,
        options_for_select(@buses.map { |b| ["#{b.plate_number} - #{b.model} (#{b.capacity} seats)", b.id] }, bus_schedule.bus_id),
        { prompt: "Select a bus" },
        class: "w-full px-3 py-2 border border-gray-300 rounded-lg " %>
  </div>

  <%# Route Selection %>
  <div>
    <%= form.label :route_id, "Route", class: "block text-sm font-medium text-gray-700 mb-1" %>
    <%= form.select :route_id,
        options_for_select(@routes.map { |r| ["#{r.origin_province.name} â†’ #{r.destination_province.name} (#{r.distance_km}km)", r.id] }, bus_schedule.route_id),
        { prompt: "Select a route" },
        class: "w-full px-3 py-2 border border-gray-300 rounded-lg " %>
  </div>

  <%# Departure Time %>
  <div>
    <%= form.label :departure_time, "Departure Time", class: "block text-sm font-medium text-gray-700 mb-1" %>
    <%= form.datetime_local_field :departure_time,
        class: "w-full px-3 py-2 border border-gray-300 rounded-lg " %>
  </div>

  <%# Arrival Time %>
  <div>
    <%= form.label :arrival_time, "Arrival Time", class: "block text-sm font-medium text-gray-700 mb-1" %>
    <%= form.datetime_local_field :arrival_time,
        class: "w-full px-3 py-2 border border-gray-300 rounded-lg " %>
  </div>

  <%# Available Seats %>
  <div>
    <%= form.label :available_seats, "Available Seats", class: "block text-sm font-medium text-gray-700 mb-1" %>
    <%= form.number_field :available_seats,
        min: 0,
        class: "w-full px-3 py-2 border border-gray-300 rounded-lg " %>
  </div>

  <%# Seat Price %>
  <div>
    <%= form.label :seat_price, "Seat Price ($)", class: "block text-sm font-medium text-gray-700 mb-1" %>
    <%= form.number_field :seat_price,
        min: 0,
        step: 0.01,
        class: "w-full px-3 py-2 border border-gray-300 rounded-lg " %>
  </div>

  <%# Status Selection %>
  <div>
    <%= form.label :status, "Status", class: "block text-sm font-medium text-gray-700 mb-1" %>
    <%= form.select :status,
        BusSchedule.statuses.keys.map { |s| [s.humanize, s] },
        {},
        class: "w-full px-3 py-2 border border-gray-300 rounded-lg " %>
  </div>

  <%# Submit Button %>
  <div class="pt-4">
    <%= form.submit bus_schedule.persisted? ? "Update Schedule" : "Create Schedule",
        class: "w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors cursor-pointer" %>
  </div>
<% end %>
